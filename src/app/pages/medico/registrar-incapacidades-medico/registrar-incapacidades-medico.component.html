<div>
    <a href="/medico-pacientes">
        <button class="boton-admin" style="width: 57%; border-radius: 0 0 10px 10px; margin-left: 21.5%; margin-right: 21.5%;" onclick="goBack()">↺ Atrás</button>
    </a>
</div>
<br>
<div class="container" style="max-width: 900px; margin: 50px auto; padding: 20px; box-shadow: 0 4px 8px #000000; background-color: transparent; border-radius: 20px; margin-top: 25px;">
    <h1 style="font-size: 45px; color: #2c91d5; padding: 5px; text-shadow: 1px 1px 2px #000000; text-align: center;">Registrar Incapacidad</h1>
    <div class="orden-medica">
        <form id="incapacidadForm" #incapacidadForm="ngForm" (ngSubmit)="onSubmit()">


            <div class="orden-info" style="border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-top: 10px; background-color: #fff; box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);">
                <label for="nombrePaciente" style="font-weight: bold; margin-right: 10px; color: #000;">Nombre del Paciente:</label>
                <select required [(ngModel)]="incapacidad.paciente" name="paciente" id="paciente" class="selectLogin" style="display: block;margin: 0 auto;margin-bottom: 30px;padding: 8px;border-radius: 17px;width: 480px;color: rgb(14, 14, 14);background-color: rgb(255, 255, 255);padding: 12px; border: 1px solid #9e9e9e; border-radius: 15px; width: 100%; font-size: 20px;" (change)="filtrarCitasPorPaciente()">
                    <option *ngFor="let user of usersPacientes" [ngValue]="user.documento + ' ' + user.primerNombre + ' ' + (user.segundoNombre ? user.segundoNombre + ' ' : '') + user.primerApellido + ' ' + (user.segundoApellido ? user.segundoApellido : '')">
                        {{ user.documento }} - {{ user.primerNombre }} {{ user.segundoNombre }} {{ user.primerApellido }} {{ user.segundoApellido }}
                    </option>
                </select>            
            </div>
            

        
            <div class="orden-info" style="border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-top: 10px; background-color: #fff; box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);">
                <label for="medico" style="font-weight: bold; margin-right: 10px; color: #000;">Médico Tratante:</label>
                <p>
                    {{ userInfo.documento }} - {{ userInfo.primerNombre }} {{ userInfo.segundoNombre }} {{ userInfo.primerApellido }} {{ userInfo.segundoApellido }}
                </p>        
            </div>

            
            <div class="orden-info" style="border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-top: 10px; background-color: #fff; box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);">
                <label for="fechaIncapacidad" style="font-weight: bold; margin-right: 10px; color: #000;">Fecha de Incapacidad:</label>
                <select required [(ngModel)]="incapacidad.fecha" name="cita" id="cita" class="selectLogin" style="display: block;margin: 0 auto;margin-bottom: 30px;padding: 8px;border-radius: 17px;width: 480px;color: rgb(14, 14, 14);background-color: rgb(255, 255, 255);padding: 12px; border: 1px solid #9e9e9e; border-radius: 15px; width: 100%; font-size: 20px;">
                    <option *ngFor="let cita of citasFiltradas" [ngValue]="cita.fecha">
                        {{ cita.paciente }} - {{ cita.fecha }}
                    </option>
                </select>               
            </div>
            
            <div class="orden-info" style="border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-top: 10px; background-color: #fff; box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);">
                <label for="tipoIncapacidad" style="font-weight: bold; margin-right: 10px; color: #000;">Tipo de Incapacidad:</label>
                <select required [(ngModel)]="incapacidad.tipo" id="tipoIncapacidad" name="tipoIncapacidad" class="selectLogin" style="display: block;margin: 0 auto;margin-bottom: 30px;padding: 8px;border-radius: 17px;width: 480px;color: rgb(14, 14, 14);background-color: rgb(255, 255, 255);padding: 12px; border: 1px solid #9e9e9e; border-radius: 15px; width: 100%; font-size: 20px;">
                    <option value="">Seleccione un tipo</option>
                    <option value="enfermedad">Enfermedad</option>
                    <option value="accidente">Accidente</option>
                    <option value="maternidad">Maternidad</option>
                    <option value="otros">Otros</option>
                </select>
            </div>
            <div class="orden-info" style="border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-top: 10px;background-color: #fff; box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);">
                <label for="detalleIncapacidad" style="font-weight: bold; margin-right: 10px; color: #000;">Detalles de la Incapacidad:</label>
                <textarea required [(ngModel)]="incapacidad.detalles" id="detalleIncapacidad" name="detalleIncapacidad" style="padding: 10px; border: none; width: 100%; font-size: 14px; margin-top: 5px;" rows="4" placeholder="Ingrese Los Detalles De La Incapacidad"></textarea>
            </div>
            <div class="orden-info" style="text-align: center; margin-top: 20px;">
                <button type="submit" class="button button-contactForm boxed-btn" [disabled]="!incapacidadForm.form.valid && isFormSubmitted">
                    Registrar Incapacidad
                </button>
            </div>
        </form>
    </div>
</div>
<br><br><br>
<div class="row no-gutters">
    <div class="col-xl-12" style="background-color: #feffff;margin-top: 40px; ">
        <div style="margin-top: -90px;">
            <div>
                <div>
                    <form class="formSedeBuscar">
                        <h1>ㅤ</h1>
                        <div class="form-group">
                            <label class="labelSedeBuscar" for="filtroPaciente" style="font-size: 20px; font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; color: #101010; margin-left: 10%; margin-right: 10%;">Filtrar Por Paciente</label>
                            <input placeholder="Doc Del Paciente O Nombre" type="text" class="form-control" [(ngModel)]="filtroPaciente" name="filtroPaciente" style="margin-left: 10%; margin-right: 10%; width: 80%;">
                        </div>
                        <div class="form-group">
                            <label class="labelSedeBuscar" for="filtroMedico" style="font-size: 20px; font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; color: #101010; margin-left: 10%; margin-right: 10%;">Filtrar Por Medico</label>
                            <input placeholder="Doc Del Medico O Nombre" type="text" class="form-control" [(ngModel)]="filtroMedico" name="filtroMedico" style="margin-left: 10%; margin-right: 10%; width: 80%;">
                        </div>
                        <h1>ㅤ</h1>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-12" style="background-color: rgb(255, 255, 255);">
        <div>
            <table class="table table-striped table-responsive" style="width: 80%; margin: 0 auto; border-collapse: separate; border-spacing: 0; margin-top: 50px;">
                <thead>
                    <tr>
                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff; border-top-left-radius: 10px;">ID</th>
                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff;">Paciente</th>

                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff;">Médico</th>
                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff;">Fecha de Incapacidad</th>
                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff;">Tipo de Incapacidad</th>
                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff;">Detalles De Incapacidad</th>
                        <th style="padding: 12px; text-align: center; background-color: #009DFF; color: #fff;  border-top-right-radius: 10px;">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let incapacida of filtrarIncapacidad(incapacidadd) || []; let i = index" [class.odd]="i % 2 !== 0">
                        <td style="padding: 10px; text-align: center;">{{ incapacida.id }}</td>
                        <td style="padding: 10px; text-align: center;">{{ incapacida.paciente }}</td>
                        <td style="padding: 10px; text-align: center;">{{ incapacida.medico }}</td>
                        <td style="padding: 10px; text-align: center;">{{ incapacida.fecha }}</td>
                        <td style="padding: 10px; text-align: center;">{{ incapacida.tipo }}</td>
                        <td style="padding: 10px; text-align: center;">{{ incapacida.detalles }}</td>
                        <td class="text-center">
                            <a (click)="borrarIncapacidad(incapacida.id.toString())" style="color: #fff;">
                                <img src='../../../../assets/images/eliminar.png' alt='Eliminar incapacidad' style='width: 19px; height: 19px;'>
                            </a>
                        </td> 
                    </tr>
                    
                </tbody>
            </table>
        </div>
    </div>
</div>